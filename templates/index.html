<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>🌐 Painel IA dos Mercados</title>
  <link rel="stylesheet" href="/static/style.css">

  <!-- Chart.js + plugin -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.2.1"></script>

  <!-- Ícone -->
  <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/846/846449.png">
</head>
<body>
  <!-- 🔹 Fundo animado -->
  <canvas id="particles"></canvas>

  <!-- 🔹 Cabeçalho -->
  <header>
    <h1>🤖 Painel de Previsão dos Mercados</h1>
    <p class="subtitle">Análise em tempo real com IA — Global 🌍 • Europa 🇪🇺 • Cripto ₿</p>
  </header>

  <!-- 🔹 Botão Atualizar -->
  <button id="refreshButton">🔄 Atualizar Agora</button>

  <!-- 🔹 Resumo da IA -->
  <div class="summary">
    <p>Carregando dados dos mercados...</p>
  </div>

  <!-- 🔹 Gráfico principal -->
  <section class="main-chart">
    <h2>📊 Histórico da IA (Probabilidade Média)</h2>
    <canvas id="iaChart"></canvas>
  </section>

  <!-- 🔹 Cards dos Mercados -->
  <div class="markets-container"></div>

  <!-- 🔹 Loading -->
  <div class="loading">🔄 A carregar dados...</div>

  <!-- 🔹 Som IA -->
  <audio id="iaSound" src="/static/bip.mp3" preload="auto"></audio>

  <!-- 🧠 Glossário Técnico -->
  <footer class="glossario">
    <div class="glossario-content">
      <h3>📘 Glossário Técnico IA</h3>
      <div class="glossario-grid">
        <div class="term" data-tooltip="RSI — Índice de Força Relativa. Mede força e direção do movimento. Acima de 70 indica sobrecompra, abaixo de 30 sobrevenda.">RSI</div>
        <div class="term" data-tooltip="EMA5 — Média Móvel Exponencial de 5 dias. Reflete o preço recente com mais peso. Indica força de curto prazo.">EMA5</div>
        <div class="term" data-tooltip="EMA20 — Média Móvel Exponencial de 20 dias. Suaviza oscilações e mostra a tendência principal.">EMA20</div>
        <div class="term" data-tooltip="Mom5 — Momentum de 5 dias. Mede a aceleração ou desaceleração da tendência.">Mom5</div>
        <div class="term" data-tooltip="Vol10 — Volatilidade média dos últimos 10 dias. Indica o grau de variação e risco.">Vol10</div>
        <div class="term" data-tooltip="Prob. IA — Probabilidade de subida segundo o modelo IA para as próximas 24h.">Prob. IA</div>
        <div class="term" data-tooltip="Conf. IA — Grau de confiança da IA. Valores mais altos significam menor incerteza.">Conf. IA</div>
        <div class="term" data-tooltip="Tendência — Síntese global dos sinais técnicos e padrões recentes para prever direção.">Tendência</div>
      </div>
    </div>
  </footer>

  <!-- 🔹 Script principal -->
  <script src="/static/script.js"></script>

  <!-- 🌌 Partículas animadas -->
  <script>
    const canvas = document.getElementById('particles');
    const ctx = canvas.getContext('2d');
    let particlesArray = [];

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    class Particle {
      constructor() {
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.size = Math.random() * 2;
        this.speedX = (Math.random() - 0.5) * 0.4;
        this.speedY = (Math.random() - 0.5) * 0.4;
      }
      update() {
        this.x += this.speedX;
        this.y += this.speedY;
        if (this.x < 0 || this.x > canvas.width) this.speedX *= -1;
        if (this.y < 0 || this.y > canvas.height) this.speedY *= -1;
      }
      draw() {
        ctx.fillStyle = 'rgba(0,255,255,0.25)';
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function initParticles() {
      particlesArray = [];
      const count = Math.min(80, canvas.width / 20);
      for (let i = 0; i < count; i++) particlesArray.push(new Particle());
    }

    function animateParticles() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      particlesArray.forEach(p => { p.update(); p.draw(); });
      requestAnimationFrame(animateParticles);
    }

    initParticles();
    animateParticles();
  </script>

  <!-- ⚙️ Script para tooltips -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const tooltip = document.createElement("div");
      tooltip.id = "tooltip-global";
      Object.assign(tooltip.style, {
        position: "fixed",
        background: "rgba(0,255,255,0.95)",
        color: "#000",
        padding: "8px 12px",
        borderRadius: "6px",
        boxShadow: "0 0 12px rgba(0,255,255,0.6)",
        fontSize: "0.9em",
        pointerEvents: "none",
        opacity: "0",
        transition: "opacity 0.2s, transform 0.2s",
        zIndex: "999999"
      });
      document.body.appendChild(tooltip);

      document.querySelectorAll(".term").forEach(el => {
        el.addEventListener("mouseenter", e => {
          tooltip.textContent = el.getAttribute("data-tooltip");
          tooltip.style.opacity = "1";
          tooltip.style.transform = "translateY(-8px)";
        });
        el.addEventListener("mousemove", e => {
          tooltip.style.left = e.clientX + 15 + "px";
          tooltip.style.top = e.clientY - 20 + "px";
        });
        el.addEventListener("mouseleave", () => {
          tooltip.style.opacity = "0";
        });
      });
    });
  </script>
</body>
</html>

