<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸŒ Painel IA dos Mercados</title>
  <link rel="stylesheet" href="/static/style.css">

  <!-- Chart.js + plugin -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.2.1"></script>

  <!-- Ãcone -->
  <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/846/846449.png">
</head>
<body>
  <!-- ğŸ”¹ Fundo animado -->
  <canvas id="particles"></canvas>

  <!-- ğŸ”¹ CabeÃ§alho -->
  <header>
    <h1>ğŸ¤– Painel de PrevisÃ£o dos Mercados</h1>
    <p class="subtitle">AnÃ¡lise em tempo real com IA â€” Global ğŸŒ â€¢ Europa ğŸ‡ªğŸ‡º â€¢ Cripto â‚¿</p>
  </header>

  <!-- ğŸ”¹ BotÃ£o Atualizar -->
  <button id="refreshButton">ğŸ”„ Atualizar Agora</button>

  <!-- ğŸ”¹ Resumo da IA -->
  <div class="summary">
    <p>Carregando dados dos mercados...</p>
  </div>

  <!-- ğŸ”¹ GrÃ¡fico principal -->
  <section class="main-chart">
    <h2>ğŸ“Š HistÃ³rico da IA (Probabilidade MÃ©dia)</h2>
    <canvas id="iaChart"></canvas>
  </section>

  <!-- ğŸ”¹ Cards dos Mercados -->
  <div class="markets-container"></div>

  <!-- ğŸ”¹ Loading -->
  <div class="loading">ğŸ”„ A carregar dados...</div>

  <!-- ğŸ”¹ Som IA -->
  <audio id="iaSound" src="/static/bip.mp3" preload="auto"></audio>

  <!-- ğŸ§  GlossÃ¡rio TÃ©cnico -->
  <footer class="glossario">
    <div class="glossario-content">
      <h3>ğŸ“˜ GlossÃ¡rio TÃ©cnico IA</h3>
      <div class="glossario-grid">
        <div class="term" data-tooltip="RSI â€” Ãndice de ForÃ§a Relativa. Mede forÃ§a e direÃ§Ã£o do movimento. Acima de 70 indica sobrecompra, abaixo de 30 sobrevenda.">RSI</div>
        <div class="term" data-tooltip="EMA5 â€” MÃ©dia MÃ³vel Exponencial de 5 dias. Reflete o preÃ§o recente com mais peso. Indica forÃ§a de curto prazo.">EMA5</div>
        <div class="term" data-tooltip="EMA20 â€” MÃ©dia MÃ³vel Exponencial de 20 dias. Suaviza oscilaÃ§Ãµes e mostra a tendÃªncia principal.">EMA20</div>
        <div class="term" data-tooltip="Mom5 â€” Momentum de 5 dias. Mede a aceleraÃ§Ã£o ou desaceleraÃ§Ã£o da tendÃªncia.">Mom5</div>
        <div class="term" data-tooltip="Vol10 â€” Volatilidade mÃ©dia dos Ãºltimos 10 dias. Indica o grau de variaÃ§Ã£o e risco.">Vol10</div>
        <div class="term" data-tooltip="Prob. IA â€” Probabilidade de subida segundo o modelo IA para as prÃ³ximas 24h.">Prob. IA</div>
        <div class="term" data-tooltip="Conf. IA â€” Grau de confianÃ§a da IA. Valores mais altos significam menor incerteza.">Conf. IA</div>
        <div class="term" data-tooltip="TendÃªncia â€” SÃ­ntese global dos sinais tÃ©cnicos e padrÃµes recentes para prever direÃ§Ã£o.">TendÃªncia</div>
      </div>
    </div>
  </footer>

  <!-- ğŸ”¹ Script principal -->
  <script src="/static/script.js"></script>

  <!-- ğŸŒŒ PartÃ­culas animadas -->
  <script>
    const canvas = document.getElementById('particles');
    const ctx = canvas.getContext('2d');
    let particlesArray = [];

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    class Particle {
      constructor() {
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.size = Math.random() * 2;
        this.speedX = (Math.random() - 0.5) * 0.4;
        this.speedY = (Math.random() - 0.5) * 0.4;
      }
      update() {
        this.x += this.speedX;
        this.y += this.speedY;
        if (this.x < 0 || this.x > canvas.width) this.speedX *= -1;
        if (this.y < 0 || this.y > canvas.height) this.speedY *= -1;
      }
      draw() {
        ctx.fillStyle = 'rgba(0,255,255,0.25)';
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function initParticles() {
      particlesArray = [];
      const count = Math.min(80, canvas.width / 20);
      for (let i = 0; i < count; i++) particlesArray.push(new Particle());
    }

    function animateParticles() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      particlesArray.forEach(p => { p.update(); p.draw(); });
      requestAnimationFrame(animateParticles);
    }

    initParticles();
    animateParticles();
  </script>

  <!-- âš™ï¸ Script para tooltips -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const tooltip = document.createElement("div");
      tooltip.id = "tooltip-global";
      Object.assign(tooltip.style, {
        position: "fixed",
        background: "rgba(0,255,255,0.95)",
        color: "#000",
        padding: "8px 12px",
        borderRadius: "6px",
        boxShadow: "0 0 12px rgba(0,255,255,0.6)",
        fontSize: "0.9em",
        pointerEvents: "none",
        opacity: "0",
        transition: "opacity 0.2s, transform 0.2s",
        zIndex: "999999"
      });
      document.body.appendChild(tooltip);

      document.querySelectorAll(".term").forEach(el => {
        el.addEventListener("mouseenter", e => {
          tooltip.textContent = el.getAttribute("data-tooltip");
          tooltip.style.opacity = "1";
          tooltip.style.transform = "translateY(-8px)";
        });
        el.addEventListener("mousemove", e => {
          tooltip.style.left = e.clientX + 15 + "px";
          tooltip.style.top = e.clientY - 20 + "px";
        });
        el.addEventListener("mouseleave", () => {
          tooltip.style.opacity = "0";
        });
      });
    });
  </script>
</body>
</html>

